---
title: "Technical Appendix"
author: "Ilayda Dinc & Sara Orofino"
date: "5/28/2019"
output: pdf_document
---

```{r setup, include=FALSE, message=FALSE}
# Packages and data

library(tidyverse)
library(janitor)

carbon <- read_csv("HW4Data.csv") %>% 
  clean_names()

```

###1. Marginal Cost of Abatement by Sector 

####Sector A

```{r, include=FALSE, message=FALSE}
# First make trial graph to see what function it might be 
trial_a <- ggplot(carbon, aes(x=abatement, y=mc_a)) +
  geom_point() +
  geom_smooth()

trial_a 

# Looks linear

# Use linear regression to find the equation of the line

a_lm <- lm(mc_a ~ abatement, data=carbon)

# Store coefficients of regression
int_a <- a_lm$coefficients[1]
slope_a <- a_lm$coefficients[2]

 
```

$Marginal~Cost~Abatement~Sector~A = `r slope_a`*q + `r int_a`$  

####Sector B

```{r, include=FALSE, message=FALSE}

# First make trial graph to see what function it might be
trial_b <- ggplot(carbon, aes(x=abatement, y=mc_b)) +
  geom_point() +
  geom_smooth()

trial_b

# looks polynomial ...

# Try fitting polynomial regression

b_lm <- lm(mc_b ~ abatement + I(abatement^2) + I(abatement^3), data = carbon)

# Graph it to check the fit 
b_lm_graph <- ggplot(carbon, aes(x=abatement, y=mc_b)) +
  geom_point() + 
  geom_smooth(method = "lm", formula = y~x+I(x^2)+ I(x^3))

b_lm_graph

# Fit looks okay - save the regression coefficients
int_b <- b_lm$coefficients[1]
c1_b <- b_lm$coefficients[2]
c2_b <- b_lm$coefficients[3]
c3_b <- b_lm$coefficients[4]

```

$Marginal~Cost~Abatement~Sector~B = `r int_b` + (`r c1_b`)q + (`r c2_b`)q^2 + (`r c3_b`)q^3$   


####Sector C

```{r, include=FALSE, message=FALSE}
# First make trial graph to see what function it might be
trial_c <- ggplot(carbon, aes(x=abatement, y=mc_c)) +
  geom_point() +
  geom_smooth()

trial_c

# Looks exponential (check lab 4 from 244 if you have to use nls)


```



####Sector D

```{r, include=FALSE, message=FALSE}
# First make trial graph to see what function it might be
trial_d <- ggplot(carbon, aes(x=abatement, y=mc_d)) +
  geom_point() +
  geom_smooth()

trial_d
# ????

```

###2. Demand for Carbon Emissions 

```{r, include=FALSE}

####### Sector A Demand Curve:  
# Current emissions are 180 - use quantities from 0 to 180 by 10
quantity_a <- seq(0,180,by=10)


# Write function for demand curve for Sector A

d_a <- function(q){
  (slope_a*(180-q)) + int_a
}

# Derive demand curve using the values above
demand_a <- d_a(quantity_a)

# Graph it to see if this worked....
curve(d_a, from=0, to=180, xlab = "x", ylab = "y")

# willing to pay 95.2 for the first ton of emissions 


######## Sector B Demand Curve:  

# Current emissions are 200 - use quantities from 0 to 200 by 10
quantity_b <- seq(0,200,by=10)

# Write function for demand curve for Sector B

d_b <- function(q){
  (c1_b*(200-q) + c2_b*((200-q)^2) + c3_b*((200-q)^3) + int_b)
}

# Graph it 
curve(d_b, from=0, to=200, xlab = "x", ylab = "y")

# Plug in quantities into function to check
demand_b <- d_b(quantity_b)
```



*Demand Curves*  

Sector A:  $Price~of~Emissions = `r slope_a`*(180-q) + `r int_a`$  
 - Willingness to Pay for First Unit = \$95.2    

Sector B:  

###3. Country X

Suppose to meet the Paris Accord commitments, Country X (which contains sectors A, B, and C) needs to cut all carbon emissions in half. For each policy option derive the following:  
1. The total cost of meeting the target in Country X  
2. The cost (or benefit) to each sector  
3. The tax revenue generated  

####a. Cap on Carbon  




1. Total Cost of Carbon Cap   

2. Cost/Benefits to each Sector  

3. Tax Revenue  

####b. Tax on Carbon 



1. Total Cost of Carbon Cap     

2. Cost/Benefits to each Sector    

3. Tax Revenue    


####c. Cap and Trade  




1. Total Cost of Carbon Cap     

2. Cost/Benefits to each Sector    

3. Tax Revenue    



###4. Country Y

Country Y contains only Sector D and is not obligated to reduce its emissions. To enter into Country X's carbon market Country Y would need to cap its emissions at its current level (300 tons) but allows them to sell credits to Sectors A, B, and C in Country X.   

Incentives for Country Y to enter the carbon market:  


Incentives for Country X to attract Country Y to the carbon market:  


###5. Local Air Pollution  

Now assume every ton of carbon emissions creates one ton of local air pollution. Local air pollution only causes economic damages in the country where it is emitted. Neither Country X nor Country Y have local air pollution regulations.  

####a. Carbon Cap and Trade Market only Covering Country X  

How much local air pollution would you expect in Country X and Country Y?  



####b. Country Y enters the Carbon Market of Country X  

How much local air pollution would you expect in Country X and Country Y?  




####c. Advice on International Trade of Carbon Emission Credits  

